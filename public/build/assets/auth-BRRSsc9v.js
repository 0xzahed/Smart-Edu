document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("loginForm");if(t){const s=document.getElementById("emailInput"),o=document.getElementById("passwordInput"),l=document.getElementById("roleInput");document.querySelectorAll(".role-tab").forEach(r=>{r.addEventListener("click",()=>{document.querySelectorAll(".role-tab").forEach(i=>i.classList.remove("active")),r.classList.add("active"),l.value=r.dataset.role})}),t.addEventListener("submit",r=>{let i=!1;const a=s.value.trim();/@diu\.edu\.bd$/i.test(a)?(document.getElementById("emailError")?.classList.add("hidden"),s.classList.remove("ring-2","ring-red-400")):(i=!0,document.getElementById("emailError")?.classList.remove("hidden"),s.classList.add("ring-2","ring-red-400")),o.value?document.getElementById("passwordError")?.classList.add("hidden"):(i=!0,document.getElementById("passwordError")?.classList.remove("hidden")),i&&r.preventDefault()})}document.getElementById("registrationForm")});document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("loginForm")!==null;if(document.getElementById("registrationForm"),t){let m=function(){const e=r.value.trim(),n=i.value.trim();return e?e.includes("@diu.edu.bd")?n?n.length<6?(showError("Password must be at least 6 characters long"),!1):!0:(showError("Please enter your password"),!1):(showError("Please use your @diu.edu.bd email address"),!1):(showError("Please enter your email"),!1)};var s=m;const o=document.querySelectorAll(".role-tab"),l=document.getElementById("loginForm"),r=document.getElementById("emailInput"),i=document.getElementById("passwordInput"),a=document.getElementById("loginButton"),c=document.getElementById("roleInput");let d="student";o.forEach(e=>{e.addEventListener("click",function(){o.forEach(n=>{n.classList.remove("active")}),this.classList.add("active"),d=this.getAttribute("data-role"),c.value=d})}),l.addEventListener("submit",function(e){if(e.preventDefault(),!m())return;a.disabled=!0,a.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Signing In...';const n=document.createElement("input");n.type="hidden",n.name="role",n.value=d;const u=this.querySelector('input[name="role"]');u&&u!==document.getElementById("roleInput")&&u.remove();const h=document.getElementById("roleInput");h?h.value=d:this.appendChild(n),this.submit()}),[r,i].forEach(e=>{e.addEventListener("focus",function(){this.parentElement.classList.add("ring-2","ring-white/30")}),e.addEventListener("blur",function(){this.parentElement.classList.remove("ring-2","ring-white/30")})});const g=document.getElementById("googleLogin"),f=document.getElementById("githubLogin");g&&g.addEventListener("click",function(e){e.preventDefault(),window.location.href=`/auth/google?role=${d}`}),f&&f.addEventListener("click",function(e){e.preventDefault(),window.location.href=`/auth/github?role=${d}`}),document.getElementById("forgotPasswordLink")?.addEventListener("click",function(e){e.preventDefault(),showInfo("Forgot password functionality will be implemented soon!")});const E=document.getElementById("registerLink");E&&E.addEventListener("click",function(e){e.preventDefault(),window.location.href="/register"})}});window.authPageFunctions={showError:function(t){console.error("Auth Error:",t)},showMessage:function(t,s){console.log(`Auth ${s}:`,t)}};window.loginWithGoogle=function(t){document.querySelectorAll('button[onclick*="loginWithGoogle"]').forEach(o=>{o.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed");const l=o.querySelector("span");l&&(l.innerHTML='<i class="fas fa-spinner fa-spin mr-2"></i>Redirecting...')}),window.location.href=`/auth/google/${t}`};
